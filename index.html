<!DOCTYPE html>
<html lang="ru">
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Найди всех</title>
</head>
<body>
    <h1>Найди всех птиц на картинке</h1>
    
    <div class="object-description" id="object-description">
        Начните игру - кликайте на объекты на изображении <br>
		Когда найдутся все, игра сообщит!
    </div>
    
    <div class="controls">
        <button id="resetGame">Сбросить игру</button>
    </div>
    
    <div class="game-container">
        <img id="game-image" src="base.jpg" alt="Игровое поле" style="filter: brightness(0.5);">                                                       
        <div class="game-start-overlay" id="game-start-overlay">
            <button class="start-button" id="startButton">Начать!</button>
        </div>                                                       
        <div class="congratulations" id="congratulations">Поздравляем! Вы нашли всех!</div>
    </div>
    
    <div class="info-panel" id="info-panel">
        Найдено: <span id="found-count">0</span>
    </div>
    
    <div class="debug-info" id="debug-info">
        Координаты: <span id="mouse-coords">0, 0</span>
    </div>
    
    <audio id="bgMusic" loop>
        <source src="arr.scht - find the birds.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="foundSound">
        <source src="found.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // Конфигурация игры
        const gameConfig = {
            objects: [
                {
                    id: 1,
                    circles: [
                        { x: 158, y: 975, r: 25 },
                        { x: 184, y: 916, r: 35 },
						{ x: 188, y: 854, r: 35 },
                    ],
                    description: "Это Большой пестрый дятел — питается древесными насекомыми, которых добывает из-под коры, выдалбливая мощным клювом с характерным стуком."
                },
                {
                    id: 2,
                    circles: [
                        { x: 716, y: 507, r: 40 }
                    ],
                    description: "Это Поползень — весьма подвижный, способен передвигаться по стволам вниз головой; запасает семена, засовывая их в щели коры."
                },
                {
                    id: 3,
                    circles: [
                        { x: 1174, y: 301, r: 30 },
                        { x: 1195, y: 259, r: 25 },					
                    ],
                    description: "Это Мухоловка-пеструшка — ловит насекомых на лету, совершая короткие вылеты с ветки и возвращаясь обратно; гнездится в дуплах деревьев."
                },
                {
                    id: 4,
                    circles: [
                        { x: 1456, y: 749, r: 25 },
						{ x: 1420, y: 783, r: 25 }
                    ],
                    description: "Это Обыкновенная горихвостка - часто встречается в садах и парках, где ловит насекомых на земле и в воздухе; узнаваема по яркой окраске и звонкой песне"
                },
				{
                    id: 5,
                    circles: [
                        { x: 2024, y: 492, r: 25 },
						{ x: 1992, y: 530, r: 25 }
                    ],
                    description: "Это Домовый воробей – широко распространённая городская птица, питается семенами и пищевыми отходами; активный, шумный, часто держится возле человеческого жилья."
                },
				{
                    id: 6,
                    circles: [
                       { x: 1054, y: 578, r: 25 },
                    ],
                    description: "Это Буроголовая гаичка (пухляк) – птица из семейства синиц, питающаяся насекомыми и семенами; зимой охотно посещает кормушки в парках."
                },
				{
                    id: 7,
                    circles: [
                        { x: 928, y: 789, r: 35 },
						{ x: 934, y: 862, r: 45 },
						{ x: 949, y: 945, r: 45 },
						{ x: 883, y: 820, r: 25 },
						
                    ],
                    description: "Это Сорока — всеядная птица с характерным стрекотанием; строит большие шарообразные гнезда из веток, любит блестящие предметы."
                },	
				{
                    id: 8,
                    circles: [
                        { x: 1007, y: 1288, r: 35 },
						{ x: 1015, y: 1337, r: 35 },
						
                    ],
                    description: "Это Зяблик — питается семенами, зелеными частями растений и насекомыми; весной и летом его легко узнать по характерной песне как в лесах, так и в городской среде."
                },
				{
                    id: 9,
                    circles: [
                        { x: 1490, y: 1228, r: 35 },
						{ x: 1477, y: 1284, r: 35 }
						
                    ],
                    description: "Это Свиристель – перелётная птица с мелодичной трелью; весной образует большие стаи; питается ягодными кустарниками, особенно рябиной."
                },
				{
                    id: 10,
                    circles: [
                        { x: 2247, y: 892, r: 30 }
						
                    ],
                    description: "Это Зарянка – насекомоядная лесная птица с узнаваемой оранжевой грудкой; активный певец, чьи трели особенно часто слышны на рассвете и в сумерках."
                },
				{
                    id: 11,
                    circles: [
                        { x: 2277, y: 368, r: 35 },
						{ x: 2315, y: 410, r: 35 }
						
                    ],
                    description: "Это Скворец — всеядная перелетная птица, гнездящаяся в дуплах; известен способностью имитировать различные звуки и пение других птиц."
                },
				{
                    id: 12,
                    circles: [
                        { x: 207, y: 699, r: 35 },
						{ x: 256, y: 672, r: 35 }
						
                    ],
                    description: "Это Черный коршун — хищник, преимущественно питающийся рыбой и падалью; отличается характерным кружащим полетом при высматривании добычи."
                },
				{
                    id: 13,
                    circles: [
                        { x: 2715, y: 511, r: 30 },
						{ x: 2678, y: 517, r: 35 },
						
                    ],
                    description: "Это Пеночка-весничка — насекомоядная перелетная птица с характерной звонкой песней; одна из первых появляется весной."
                },
				{
                    id: 14,
                    circles: [
                        { x: 3119, y: 413, r: 40 },
						{ x: 3119, y: 492, r: 40 },
						{ x: 3115, y: 565, r: 40 },
						
                    ],
                    description: "Это Кукушка – подкладывает яйца в гнёзда других птиц, впоследствии птенцы вытесняют законное потомство; питается преимущественно мохнатыми гусеницами."
                },
				{
                    id: 15,
                    circles: [
                        { x: 3142, y: 927, r: 35 },					
						
                    ],
                    description: "Это Чечётка – зимующая птица, питающаяся семенами берёзы и ольхи; собирается в шумные стайки, часто кочует в поисках корма."
                },
				{
                    id: 16,
                    circles: [
                        { x: 2756, y: 792, r: 35 },		
						{ x: 2783, y: 839, r: 20 },	
                        { x: 2728, y: 843, r: 40 },		
						{ x: 2753, y: 895, r: 40 },	
                        { x: 2672, y: 895, r: 45 },			
						{ x: 2623, y: 942, r: 30 },	
						
                    ],
                    description: "Это Пустельга — охотится на мелких грызунов, характерно зависая в воздухе перед атакой; в городской среде часто гнездятся под крышами зданий."
                },
				{
                    id: 17,
                    circles: [
                        { x: 2399, y: 665, r: 20 },		
						{ x: 2448, y: 635, r: 45 },	
                        { x: 2429, y: 719, r: 45 },		
						{ x: 2471, y: 687, r: 30 },	
                        						
                    ],
                    description: "Это Щегол – яркая певчая птица с мелодичной трелью, питается семенами репейника и чертополоха; часто держится небольшими стайками в садах и парках."
                },
				{
                    id: 18,
                    circles: [
                        { x: 2967, y: 1248, r: 45 },		
						{ x: 2982, y: 1322, r: 70 },	
                        { x: 3016, y: 1472, r: 55 },		
						{ x: 3004, y: 1404, r: 65 },	
                        						
                    ],
                    description: "Это Ворон – крупный всеядный хищник с глубоким каркающим криком; отличается осторожностью и высоким интеллектом."
                },
				{
                    id: 19,
                    circles: [
                        { x: 2749, y: 1579, r: 25 },
						{ x: 2775, y: 1614, r: 25 },
						
                    ],
                    description: "Это Серая славка — насекомоядная перелетная птица, гнездящаяся в кустарниках; активный певец."
                },
				{
                    id: 20,
                    circles: [
                        { x: 2578, y: 2283, r: 35 },						
						
                    ],
                    description: "Это Большая синица — подвижная птица, частый гость кормушек в городах и лесах; питается насекомыми летом и семенами зимой; обладает богатым голосовым репертуаром."
                },
				{
                    id: 21,
                    circles: [
                        { x: 2206, y: 1943, r: 25 },
						{ x: 2234, y: 1973, r: 25 },
						
                    ],
                    description: "Это Соловей — насекомоядная птица, знаменитая сложными ночными трелями; ведет скрытный образ жизни."
                },
				{
                    id: 22,
                    circles: [
                        { x: 2125, y: 1626, r: 25 },
						{ x: 2103, y: 1654, r: 25 },
						{ x: 2078, y: 1680, r: 25 },
						
                    ],
                    description: "Это Мухоловка серая — насекомоядная птица, подстерегающая добычу на ветках; отличается бесшумной охотой."
                },
				{
                    id: 23,
                    circles: [
                        { x: 1434, y: 2150, r: 25 },
						{ x: 1409, y: 2193, r: 35 },
						{ x: 1358, y: 2223, r: 25 },
						
                    ],
                    description: "Это Дрозд-рябинник — всеядная птица, осенью активно поедающая ягоды рябины; песня торопливая и неразборчивая, состоит из щебетаний, скрипов; образует стаи."
                },
				{
                    id: 24,
                    circles: [
                        { x: 759, y: 1971, r: 25 },
						{ x: 778, y: 1988, r: 30 },
						{ x: 806, y: 1990, r: 25 },
						
                    ],
                    description: "Это Белая трясогузка – насекомоядная птица, часто селящаяся у водоёмов, но хорошо адаптированная к городской среде; легко узнаётся по привычке подёргивать хвостом при беге."
                },
				{
                    id: 25,
                    circles: [
                        { x: 427, y: 1994, r: 35 },
						{ x: 380, y: 2054, r: 45 },
						{ x: 338, y: 2095, r: 45 },						
						{ x: 299, y: 2142, r: 30 },
						
                    ],
                    description: "Это Седой дятел — насекомоядная птица, питающаяся преимущественно муравьями; обычно кормится на поверхности земли, долбит относительно немного, чаще зимой; в холодное время частый гость кормушек."
                },
					
            ],
            debugMode: false,
            
        };
        
        // Состояние игры
        const gameState = {
            foundObjects: new Set(),
            debugCircles: [],
            foundCircles: [],
            lastFoundObject: null,
            bgMusicPlaying: false,
            gameActive: false    
        };
        
        // Элементы DOM
        const gameImage = document.getElementById('game-image');
        const foundCountElement = document.getElementById('found-count');
        const debugInfoElement = document.getElementById('debug-info');
        const mouseCoordsElement = document.getElementById('mouse-coords');
        const resetGameButton = document.getElementById('resetGame');
        const gameContainer = document.querySelector('.game-container');
        const congratulationsElement = document.getElementById('congratulations');
        const objectDescriptionElement = document.getElementById('object-description');
        const bgMusic = document.getElementById('bgMusic');
        const foundSound = document.getElementById('foundSound');
        const startButton = document.getElementById('startButton');
        const gameStartOverlay = document.getElementById('game-start-overlay');
        const infoPanel = document.getElementById('info-panel');
        const controls = document.querySelector('.controls');
        const debugInfo = document.getElementById('debug-info');                                                                       
        
        // Инициализация игры
        function initGame() {
            foundCountElement.textContent = gameState.foundObjects.size;
            gameImage.addEventListener('click', handleImageClick);
            resetGameButton.addEventListener('click', resetGame);
            startButton.addEventListener('click', startGame);
            updateDebugMode();
            window.addEventListener('resize', handleResize);
        }
        
        function startGame() {
            // Активируем игру
            gameState.gameActive = true;
            
            // Прячем оверлей старта
            gameStartOverlay.style.display = 'none';
            
            // Возвращаем нормальную яркость изображению
            gameImage.style.filter = 'brightness(1)';
            
            // Показываем элементы интерфейса
            infoPanel.style.display = 'block';
            objectDescriptionElement.style.display = 'block';
            controls.style.display = 'block';                                
            // Запуск фоновой музыки
            startBgMusic();
        }
        
        function startBgMusic() {
            if (!gameState.bgMusicPlaying) {
                bgMusic.play()
                    .then(() => {
                        gameState.bgMusicPlaying = true;
                    })
                    .catch(error => {
                        console.log("Автовоспроизведение музыки заблокировано:", error);
                    });
            }
        }
        
        function handleResize() {
            if (gameConfig.debugMode) {
                updateDebugMode();
            }
        }
        
        function handleImageClick(event) {
            if (!gameState.gameActive) return;
            const rect = gameImage.getBoundingClientRect();
            const scaleX = gameImage.naturalWidth / rect.width;
            const scaleY = gameImage.naturalHeight / rect.height;
            
            const x = (event.clientX - rect.left) * scaleX;
            const y = (event.clientY - rect.top) * scaleY;
            
            if (gameConfig.debugMode) {
                mouseCoordsElement.textContent = `${Math.round(x)}, ${Math.round(y)}`;
            }
            
            checkObjectHit(x, y);
        }
        
        function checkObjectHit(x, y) {
            let hitDetected = false;
            let foundObject = null;
            
            for (const obj of gameConfig.objects) {
                if (gameState.foundObjects.has(obj.id)) continue;
                
                for (const circle of obj.circles) {
                    const distance = Math.sqrt(Math.pow(x - circle.x, 2) + Math.pow(y - circle.y, 2));
                    if (distance <= circle.r) {
                        hitDetected = true;
                        foundObject = obj;
                        gameState.foundObjects.add(obj.id);
                        foundCountElement.textContent = gameState.foundObjects.size;
                        
                        // Воспроизведение звука найденного объекта
                        foundSound.currentTime = 0;
                        foundSound.play();
                        
                        // Обновление описания
                        objectDescriptionElement.textContent = obj.description;
                        gameState.lastFoundObject = obj;
                        
                        if (gameConfig.debugMode) {
                            showFoundObject(obj);
                        }
                        
                        if (gameState.foundObjects.size === gameConfig.objects.length) {
                            congratulationsElement.style.display = 'block';
                            //objectDescriptionElement.textContent = "Вы нашли всех птиц! Молодец!";
                        }
                        
                        break;
                    }
                }
                
                if (hitDetected) break;
            }
        }
        
        function showFoundObject(obj) {
            const rect = gameImage.getBoundingClientRect();
            const scaleX = rect.width / gameImage.naturalWidth;
            const scaleY = rect.height / gameImage.naturalHeight;
            
            for (const circle of obj.circles) {
                const foundCircle = document.createElement('div');
                foundCircle.className = 'found-circle';
                foundCircle.style.left = `${circle.x * scaleX}px`;
                foundCircle.style.top = `${circle.y * scaleY}px`;
                foundCircle.style.width = `${circle.r * 2 * scaleX}px`;
                foundCircle.style.height = `${circle.r * 2 * scaleY}px`;
                
                gameContainer.appendChild(foundCircle);
                gameState.foundCircles.push(foundCircle);
            }
        }
        
        function updateDebugMode() {
            debugInfoElement.style.display = gameConfig.debugMode ? 'block' : 'none';
            
            gameState.debugCircles.forEach(circle => circle.remove());
            gameState.debugCircles = [];
            
            if (!gameConfig.debugMode) {
                gameState.foundCircles.forEach(circle => circle.remove());
                gameState.foundCircles = [];
            }
            
            if (gameConfig.debugMode) {
                const rect = gameImage.getBoundingClientRect();
                const scaleX = rect.width / gameImage.naturalWidth;
                const scaleY = rect.height / gameImage.naturalHeight;
                
                for (const obj of gameConfig.objects) {
                    if (gameState.foundObjects.has(obj.id)) continue;
                    
                    for (const circle of obj.circles) {
                        const debugCircle = document.createElement('div');
                        debugCircle.className = 'debug-circle';
                        debugCircle.style.left = `${circle.x * scaleX}px`;
                        debugCircle.style.top = `${circle.y * scaleY}px`;
                        debugCircle.style.width = `${circle.r * 2 * scaleX}px`;
                        debugCircle.style.height = `${circle.r * 2 * scaleY}px`;
                        
                        gameContainer.appendChild(debugCircle);
                        gameState.debugCircles.push(debugCircle);
                    }
                }
                
                for (const obj of gameConfig.objects) {
                    if (gameState.foundObjects.has(obj.id)) {
                        showFoundObject(obj);
                    }
                }
            }
        }
        
        function resetGame() {
            gameState.foundObjects.clear();
            foundCountElement.textContent = '0';
            congratulationsElement.style.display = 'none';
            objectDescriptionElement.textContent = "Начните игру - кликайте на объекты на изображении";
            
            gameState.debugCircles.forEach(circle => circle.remove());
            gameState.debugCircles = [];
            
            gameState.foundCircles.forEach(circle => circle.remove());
            gameState.foundCircles = [];
            
            if (gameConfig.debugMode) {
                updateDebugMode();
            }
            
            // Перезапуск фоновой музыки
            bgMusic.currentTime = 0;
            startBgMusic();
        }
        
        window.addEventListener('load', () => {
            if (gameImage.complete) {
                initGame();
            } else {
                gameImage.addEventListener('load', initGame);
                gameImage.addEventListener('error', () => {
                    alert('Ошибка загрузки изображения. Убедитесь, что файл base.jpg существует.');
                });
            }
        });
    </script>
</body>
</html>